# Cloud.ru Foundation Models API Setup

## üéØ Overview

FinGPT Compliance Agents –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Cloud.ru Foundation Models API –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å –¥–ª—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ –∞—É–¥–∏–æ. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–æ—Å—Å–∏–π—Å–∫–∏–π Whisper API –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ –∞—É–¥–∏–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞.

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ü–æ–ª—É—á–µ–Ω–∏–µ API –∫–ª—é—á–∞

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ [Cloud.ru](https://cloud.ru)
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª Foundation Models
3. –°–æ–∑–¥–∞–π—Ç–µ API –∫–ª—é—á –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ Whisper API
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–ª—é—á

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª `.env.example` –≤ `.env`:

```bash
cp .env.example .env
```

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env` —Ñ–∞–π–ª:

```bash
# Cloud.ru Foundation Models API (default for audio transcription)
CLOUD_RU_API_KEY=your_actual_api_key_here
CLOUD_RU_BASE_URL=https://foundation-models.api.cloud.ru/v1

# OpenAI API (optional fallback)
OPENAI_API_KEY=your_openai_api_key_here
OPENAI_BASE_URL=https://api.openai.com/v1
```

### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

```bash
# –¢–µ—Å—Ç Cloud.ru API
make test-whisper

# –ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é
uv run python test_whisper_connection.py --provider cloud_ru --test-audio

# –¢–µ—Å—Ç OpenAI API (fallback)
make test-whisper-openai
```

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –í –∫–æ–¥–µ

```python
from src.data_collection.cloud_ru_transcriber import CloudRuTranscriber

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
transcriber = CloudRuTranscriber()

# –¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è –∞—É–¥–∏–æ
audio_array = np.array([...])  # –í–∞—à–∏ –∞—É–¥–∏–æ –¥–∞–Ω–Ω—ã–µ
sampling_rate = 16000

transcription = transcriber.transcribe_audio(
    audio_array=audio_array,
    sampling_rate=sampling_rate,
    model="openai/whisper-large-v3",
    language="ru",
    temperature=0.5
)

print(f"–¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è: {transcription}")
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã API

- **model**: `"openai/whisper-large-v3"` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- **language**: `"ru"` (—Ä—É—Å—Å–∫–∏–π), `"en"` (–∞–Ω–≥–ª–∏–π—Å–∫–∏–π), `"auto"` (–∞–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ)
- **temperature**: `0.5` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –æ—Ç 0.0 –¥–æ 1.0)
- **response_format**: `"json"` (JSON –æ—Ç–≤–µ—Ç) –∏–ª–∏ `"text"` (—Ç–µ–∫—Å—Ç–æ–≤—ã–π –æ—Ç–≤–µ—Ç)

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –∞—É–¥–∏–æ

- WAV (PCM 16-bit, 16kHz, –º–æ–Ω–æ)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏–∑ –¥—Ä—É–≥–∏—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–∞—Ä–∏—Ñ–∞ Cloud.ru

## üîÑ Fallback –Ω–∞ OpenAI

–ï—Å–ª–∏ Cloud.ru API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ø—Ä–æ–±—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å OpenAI API:

```python
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback
from src.testing.audio_tester import AudioTester

tester = AudioTester()
results = tester.run_comprehensive_test()
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –õ–æ–≥–∏

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
make logs

# –ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é
tail -f logs/training.log
```

### –°—Ç–∞—Ç—É—Å API

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
make status

# –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
make test-whisper
```

## üõ† Troubleshooting

### –û—à–∏–±–∫–∞ "API key not found"

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª `.env`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `CLOUD_RU_API_KEY` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

### –û—à–∏–±–∫–∞ "Connection failed"

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ API –∫–ª—é—á –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å base URL
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–∏–º–∏—Ç—ã API

### –û—à–∏–±–∫–∞ "No transcription returned"

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ –∞—É–¥–∏–æ
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∞—É–¥–∏–æ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–æ–π —è–∑—ã–∫
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∞—É–¥–∏–æ

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Cloud.ru –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–∏—Å** - –æ–Ω –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞
2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ OpenAI –∫–∞–∫ fallback** - –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
3. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API** - —Å–ª–µ–¥–∏—Ç–µ –∑–∞ –ª–∏–º–∏—Ç–∞–º–∏
4. **–ö—ç—à–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã** - –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ API –≤—ã–∑–æ–≤–æ–≤
5. **–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –æ—à–∏–±–∫–∏** - –≤—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —É—Å–ø–µ—à–Ω–æ—Å—Ç—å —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **–°–∫–æ—Ä–æ—Å—Ç—å**: ~2-5 —Å–µ–∫—É–Ω–¥ –Ω–∞ 1 –º–∏–Ω—É—Ç—É –∞—É–¥–∏–æ
- **–¢–æ—á–Ω–æ—Å—Ç—å**: 95%+ –¥–ª—è —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞
- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞**: –§–∏–Ω–∞–Ω—Å–æ–≤–∞—è —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏—è, —á–∏—Å–ª–∞, –¥–∞—Ç—ã
- **–õ–∏–º–∏—Ç—ã**: –ó–∞–≤–∏—Å—è—Ç –æ—Ç —Ç–∞—Ä–∏—Ñ–∞ Cloud.ru

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [Cloud.ru Foundation Models](https://cloud.ru/foundation-models)
- [Whisper API Documentation](https://platform.openai.com/docs/guides/speech-to-text)
- [FinGPT Compliance Agents](https://github.com/your-repo/fingpt-compliance-agents)